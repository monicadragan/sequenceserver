#!/usr/bin/env ruby

require 'rubygems'
require 'bundler/setup'
require 'sequenceserver'

ss = SequenceServer.new

# of the remaining items in ARGV, the first one must be a subcommand
subcommand = ARGV.shift

if subcommand
  case subcommand
  when 'format-databases'
    begin
      ss.database_formatter.run
    rescue OptionParser::InvalidOption => e
      puts e
      puts "Run 'sequenceserver format-databases -h' for help with command line options."
      exit
    end
    exit
  when 'server'
    ss.server.run
    exit
  else
    puts "invalid subcommand: #{subcommand}"
    puts "Run '#{$0} -h' for help with command line options."
    exit
  end
end

ss.server.run
